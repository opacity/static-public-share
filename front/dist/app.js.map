{"version":3,"sources":["src/index.tsx","src/pages/SharePage/SharePage.tsx","src/SiteWrapper.tsx","src/config.ts","src/pages/SharePage/preview.tsx","src/pages/SharePage/preview-renderer.tsx"],"names":["SharePage_1d","render","App","document","getElementById","shareImg","__fusereq","SharePage","history","file","react_1","window","OpacityFile","pageLoading","setPageLoading","previewOpen","setPreviewOpen","downloadFile","fetch","url","then","res","blob","Blob","file_saver_1","title","SiteWrapper_1d","react_bootstrap_1","padding","preview_1","fileExtension","mimeType","width","thumbnail","justifyContent","prev","config_1","fontSize","react_loading_1d","aos_1d","init","once","anchorPlacement","offset","delay","duration","logo","Component","constructor","props","state","showMobileMenu","showLoginModal","showSignUpModal","SetMobileMenu","setState","loggedIn","localStorage","getItem","isHome","bind","tabler_react_1","Link","open","children","footer_1d","SiteWrapper","getTypeFromExt","ext","replace","includes","undefined","Preview","type","className","onLoad","onUnload","newType","split","preview_renderer_1","text","react_markdown_1d","react_file_icon_1","PreviewRenderer","e","selection","getSelection","isCollapsed","range","createRange","selectNode","currentTarget","removeAllRanges","addRange","textAlign","map","paragraph","i","setText","catch","err","console","warn"],"mappings":"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","file":"","sourcesContent":["import * as React from \"react\";\nimport * as ReactDOM from \"react-dom\";\nimport SharePage from \"./pages/SharePage/SharePage\";\nimport \"./index.scss\";\n\nfunction App() {\n  return (\n    <SharePage />\n  );\n}\n\nReactDOM.render(<App />, document.getElementById(\"root\"));\n","import React, { useState, useMemo } from \"react\";\nimport SiteWrapper from \"../../SiteWrapper\";\nimport { Row, Col, Container } from \"react-bootstrap\";\nimport \"./SharePage.scss\";\nimport { HOME_URL } from \"../../config\"\nimport { Preview } from \"./preview\";\nimport { saveAs } from 'file-saver'\nimport ReactLoading from \"react-loading\";\n\nconst shareImg = require(\"../../assets/share-download.svg\");\n\ndeclare global {\n  interface window {\n    OpacityFile: {\n      shortlink: string,\n      url: string,\n      title: string,\n      description: string,\n      thumbnail: string,\n      mimeType: string,\n      fileExtension: string,\n    }\n  }\n}\n\nconst SharePage = ({ history }) => {\n  const file = useMemo(() => window.OpacityFile, [window.OpacityFile])\n  const [pageLoading, setPageLoading] = useState(false)\n  const [previewOpen, setPreviewOpen] = useState(false)\n\n  const downloadFile = async () => {\n    setPageLoading(true)\n    await fetch(`${file.url}`)\n      .then(res => res.blob())\n      .then(res => {\n        const blob = new Blob([res])\n        saveAs(blob, file.title)\n        setPageLoading(false)\n      })\n  }\n\n  return (\n    <>\n      <SiteWrapper history={history}>\n        <Container fluid='xl share'>\n          <Row>\n            <Col md={6} xl={12} className='center' >\n              <Row style={{ padding: '20px' }}>\n                <div className='preview-area center'>\n                  {previewOpen\n                    ?\n                    <Preview\n                      url={file.url}\n                      ext={file.fileExtension}\n                      type={file.mimeType}\n                      className='preview-content'\n                    />\n                    :\n                    <div style={{ width: \"100%\" }}>\n                      <img src={file.thumbnail} alt='thumbnail' />\n                    </div>\n                  }\n                </div>\n              </Row>\n            </Col>\n            <Col md={6} xl={12} className=\"control-area\">\n              <Row className='align-items-center'>\n                <Col className='text-center'>\n                  <div className='text-filename'>{file && file.title}</div>\n                  <div className='text-filesize'></div>\n                  <div className=\"row mb-3\" style={{ justifyContent: \"center\" }}>\n                    <div className=\"col-md-5\">\n                      <button\n                        className=\"btn btn-pill btn-download\"\n                        onClick={downloadFile}\n                      >\n                        <span></span>\n                      Download File\n                    </button>\n                    </div>\n                    <div className=\"col-md-5\">\n                      <button\n                        className=\"btn btn-pill btn-preview\"\n                        onClick={() => setPreviewOpen(prev => !prev)}\n                      >\n                        <span></span>\n                        {previewOpen ? \"Hide\" : \"Show\"} Preview\n                    </button>\n                    </div>\n                  </div>\n\n                  <h2>Easily share your files with Opacity</h2>\n\n                  <div className=\"free-signup-text\">\n                    <a href={HOME_URL + \"/plans\"} target='_blank'>Get 10GB file storage and file sharing for free</a>\n                  </div>\n                  <div style={{ fontSize: \"1.1rem\" }}>\n                    Free to share ideas. Free to be protected. Free to be you.\n                </div>\n                </Col>\n              </Row>\n            </Col>\n          </Row>\n        </Container>\n        {\n          pageLoading && <div className='loading'>\n            <ReactLoading type=\"spinningBubbles\" color=\"#2e6dde\" />\n          </div>\n        }\n      </SiteWrapper >\n    </>\n  )\n}\n\nexport default SharePage;\n","// @flow\n\nimport * as React from \"react\";\nimport type { ReactElement, ReactNode } from \"react\";\nimport { Nav, Button } from \"tabler-react\";\nimport AOS from \"aos\";\nimport type { NotificationProps } from \"tabler-react\";\nimport Footer from \"opacity-web2.0/src/components/footer/footer\";\nimport \"aos/dist/aos.css\";\nimport { HOME_URL } from \"./config\"\n\nAOS.init({\n  once: true,\n  anchorPlacement: \"center-bottom\",\n  offset: 200,\n  delay: 50,\n  duration: 700,\n});\nconst logo = require(\"./assets/logo.svg\");\ntype Props = {\n  children: ReactNode;\n  showSignUpModal?: boolean;\n  handleCloseSignUpModal?: Function;\n  showLoginModal?: boolean;\n  handleCloseLoginModal?: Function;\n  isHome?: boolean;\n  history: any;\n  recoveryHandle: string;\n};\n\ntype State = {\n  notificationsObjects?: Array<typeof NotificationProps>;\n  showMobileMenu: boolean;\n  showLoginModal: boolean;\n  showSignUpModal: boolean;\n};\n\nclass SiteWrapper extends React.Component<Props, State> {\n  constructor(props) {\n    super(props);\n    this.state = {\n      showMobileMenu: false,\n      showLoginModal: false,\n      showSignUpModal: false,\n    };\n  }\n  SetMobileMenu() {\n    this.setState({ showMobileMenu: !this.state.showMobileMenu });\n  }\n\n  render(): ReactElement {\n    const loggedIn = localStorage.getItem('key') ? true : false;\n    return (\n      <div className='page'>\n        <header\n          className={\n            this.props.isHome\n              ? \"navbar navbar-expand-md navbar-light d-print-none \"\n              : \"navbar navbar-expand-md navbar-light d-print-none border-bottom\"\n          }\n        >\n          <div className='container-xl'>\n            <h1 className='navbar-brand navbar-brand-autodark d-none-navbar-horizontal pe-0 pe-md-3 mb-0'>\n              <a href={HOME_URL + '/'} className='logo-wrapper'>\n                <img src={logo} width='60' height='60' alt='Opacity' className='navbar-brand-image' />\n                <span className='ml-3'>OPACITY</span>\n              </a>\n            </h1>\n            <button\n              className='navbar-toggler'\n              type='button'\n              data-bs-toggle='collapse'\n              data-bs-target='#navbar-menu'\n              aria-expanded={this.state.showMobileMenu}\n              onClick={this.SetMobileMenu.bind(this)}\n            >\n              <span className='navbar-toggler-icon'></span>\n            </button>\n\n            <div className='collapse navbar-collapse' id='navbar-menu'>\n              <div className='d-flex flex-column flex-md-row flex-fill align-items-stretch align-items-md-center justify-content-end'>\n                <ul className='navbar-nav'>\n                  <li className='nav-item'>\n                    <a href={HOME_URL + '/platform'} className='nav-link'>\n                      Why Opacity?\n                    </a>\n                  </li>\n                  <li className='nav-item'>\n                    <a href={HOME_URL + '/community'} className='nav-link'>\n                      App Gallery\n                    </a>\n                  </li>\n                  <li className='nav-item'>\n                    <Nav.Link href='/blog'>Learn</Nav.Link>\n                  </li>\n                  <li className='nav-item'>\n                    {loggedIn ?\n                      (\n                        <div className='nav-link'>\n                          <Button\n                            className='btn btn-primary'\n                            onClick={() => {\n                              window.open(`${HOME_URL}/file-manager`, '_blank');\n                            }}\n                          >\n                            Dashboard\n                        </Button>\n                        </div>\n                      ) : (\n                        <div className='nav-link'>\n                          <Button\n                            className='btn btn-white btn-pill'\n                            onClick={() => {\n                              window.open(`${HOME_URL}/plans`, '_blank');\n                            }}\n                          >\n                            Explore Plans\n                      </Button>\n                        </div>\n                      )\n                    }\n\n                  </li>\n                  <li className='nav-item'>\n                    {loggedIn ? (\n                      <div className=''>\n                        <Button\n                          className='btn btn-primary'\n                          onClick={() => {\n                            window.open(`${HOME_URL}/`, '_blank');\n                          }}\n                        >\n                          Logout\n                        </Button>\n                      </div>\n                    ) : (\n                      <div className=''>\n                        <Button\n                          className='btn btn-primary btn-pill'\n                          onClick={() => {\n                            window.open(`${HOME_URL}/`, '_blank');\n                          }}\n                        >\n                          Log in\n                      </Button>\n                      </div>\n                    )}\n\n                  </li>\n                </ul>\n              </div>\n            </div>\n            {this.state.showMobileMenu && (\n              <div className='mobile-menu'>\n                <div className='d-flex flex-column flex-md-row flex-fill align-items-stretch align-items-md-center justify-content-center'>\n                  <ul className='navbar-nav'>\n                    <li className='nav-item'>\n                      <a href={HOME_URL + '/platform'} className='nav-link'>\n                        Why Opacity?\n                    </a>\n                    </li>\n                    <li className='nav-item'>\n                      <a href={HOME_URL + '/community'} className='nav-link'>\n                        App Gallery\n                    </a>\n                    </li>\n                    <li className='nav-item'>\n                      <Nav.Link href='/blog'>Learn</Nav.Link>\n                    </li>\n\n                    {\n                      loggedIn ? (\n                        <>\n                          <li className='nav-item'>\n                            <a href={HOME_URL + '/file-manager'} className='nav-link' >\n                              Dashboard\n                            </a>\n                          </li>\n                          <li\n                            className='nav-item'\n                            onClick={() => {\n                              window.open(`${HOME_URL}/`, ' _blank');\n                            }}\n                          >\n                            <Nav.Link>Logout</Nav.Link>\n                          </li>\n                        </>\n                      ) : (\n                        <>\n                          <li className='nav-item'>\n                            <Nav.Link href='/plans'>Explore Plans</Nav.Link>\n                          </li>\n                          <li\n                            className='nav-item'\n                            onClick={() => {\n                              this.setState({ showLoginModal: true });\n                            }}\n                          >\n                            <Nav.Link>Log in</Nav.Link>\n                          </li>\n                        </>\n                      )\n                    }\n\n                  </ul>\n                </div>\n              </div>\n            )}\n          </div>\n        </header>\n        {this.props.children}\n        <Footer />\n      </div>\n    );\n  }\n}\n\nexport default SiteWrapper;\n","export const HOME_URL = \"https://dev2.opacity.io\"\n","import React, { useEffect } from \"react\";\nimport { PreviewRenderer } from \"./preview-renderer\";\nimport ReactMarkdown from \"react-markdown\";\nimport { FileIcon, defaultStyles } from 'react-file-icon';\n\nconst getTypeFromExt = (ext?: string) => {\n  ext = (\"\" + ext).replace(/^\\./, \"\");\n\n  if ([\n    \"png\",\n    \"apng\",\n\n    \"svg\",\n\n    \"gif\",\n\n    \"bmp\",\n\n    \"ico\",\n    \"cur\",\n\n    \"jpg\",\n    \"jpeg\",\n    \"jfif\",\n    \"pjpeg\",\n    \"pjp\",\n\n    \"webp\"\n  ].includes(ext)) {\n    return \"image\";\n  }\n\n  if ([\n    \"mp4\",\n    \"ogg\",\n    \"webm\"\n  ].includes(ext)) {\n    return \"video\";\n  }\n\n  if ([\n    \"mp3\",\n    \"flac\"\n  ].includes(ext)) {\n    return \"audio\";\n  }\n\n  if ([\n    \"txt\",\n    \"md\",\n  ].includes(ext)) {\n    return \"text\";\n  }\n\n  return undefined;\n};\n\ntype PreviewProps = {\n  ext: string\n  type?: string\n  url: string\n  className?: string\n  onLoad?: () => void\n  onUnload?: () => void\n};\n\nconst Preview = ({\n  ext,\n  type,\n  url,\n  className,\n  onLoad,\n  onUnload\n}: PreviewProps) => {\n  useEffect(() => {\n    onLoad && onLoad();\n\n    return () => {\n      onUnload && onUnload();\n    };\n  });\n\n  const newType = \"\" + (type || getTypeFromExt(ext));\n\n  switch (newType.split(\"/\")[0]) {\n    case \"image\":\n      return <img className={className} src={url} />;\n    case \"video\":\n      return (\n        <video\n          className={className}\n          controls={true}\n        >\n          <source src={url} type={type} />\n          Your browser doesn't support this video type.\n        </video>\n      );\n    case \"audio\":\n      return (\n        <audio\n          className={className}\n          controls={true}\n        >\n          <source src={url} type={type} />\n          Your browser doesn't support this audio type.\n        </audio>\n      );\n    case \"text\":\n      switch (newType.split(\"/\")[1]) {\n        case \"markdown\":\n          return (\n            <div className={className}>\n              <PreviewRenderer\n                url={url}\n                render={text => <ReactMarkdown source={text} />}\n              />\n            </div>\n          );\n        default:\n          return (\n            <div className={className}>\n              <PreviewRenderer url={url} />\n            </div>\n          );\n      }\n    default:\n      return <div style={{ width: '300px' }}>\n        <FileIcon\n          color=\"#A8A8A8\"\n          glyphColor=\"#ffffff\"\n          {...defaultStyles[ext]}\n          extension={ext}\n        />\n      </div>;\n  }\n};\n\nexport { getTypeFromExt, Preview, PreviewProps };\n","import React, { useEffect, useState } from \"react\";\n// import Spinner from \"../../components/shared/spinner\";\n\ntype PreviewRendererProps = {\n  url: string,\n  render?: (text: string) => JSX.Element | JSX.Element[]\n};\n\nconst PreviewRenderer = ({\n  url,\n  render = text => (\n    <div\n      onClick={e => {\n        const selection = getSelection();\n\n        if (selection && selection.isCollapsed) {\n          const range = document.createRange();\n          range.selectNode(e.currentTarget);\n\n          selection.removeAllRanges();\n          selection.addRange(range);\n        }\n      }}\n      style={{\n        textAlign: 'left',\n      }}\n    >\n      {text.split(/\\n+/).map((paragraph, i) => <p key={i}>{paragraph}</p>)}\n    </div>\n  )\n}: PreviewRendererProps) => {\n  const [text, setText] = useState<string>();\n\n  useEffect(() => {\n    fetch(url)\n      .then(res => res.text())\n      .then(text => setText(text))\n      .catch(err => console.warn(err));\n  }, [url]);\n\n  return (\n    <>\n      {/* <Spinner isActive={!text} /> */}\n      {text && render(text)}\n    </>\n  );\n};\n\nexport { PreviewRenderer, PreviewRendererProps };\n"]}