{"version":3,"sources":["src/index.tsx","src/pages/SharePage/SharePage.tsx","src/SiteWrapper.tsx","src/pages/SharePage/preview.tsx","src/pages/SharePage/preview-renderer.tsx"],"names":["SharePage_1d","render","App","document","getElementById","SharePage","history","file","react_1","window","OpacityFile","pageLoading","setPageLoading","downloadFile","fetch","url","then","res","blob","Blob","file_saver_1","title","SiteWrapper_1d","react_bootstrap_1","padding","preview_1","fileExtension","mimeType","description","justifyContent","opacityUrl","fontSize","react_loading_1d","aos_1d","init","once","anchorPlacement","offset","delay","duration","logo","__fusereq","Component","constructor","props","state","showMobileMenu","showLoginModal","showSignUpModal","SetMobileMenu","setState","loggedIn","localStorage","getItem","isHome","bind","tabler_react_1","Link","open","children","footer_1d","SiteWrapper","getTypeFromExt","ext","replace","includes","undefined","Preview","type","className","onLoad","onUnload","newType","split","preview_renderer_1","text","react_markdown_1d","PreviewRenderer","e","selection","getSelection","isCollapsed","range","createRange","selectNode","currentTarget","removeAllRanges","addRange","textAlign","map","paragraph","i","setText","catch","err","console","warn"],"mappings":"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","file":"","sourcesContent":["import * as React from \"react\";\nimport * as ReactDOM from \"react-dom\";\nimport SharePage from \"./pages/SharePage/SharePage\";\nimport \"./index.scss\";\n\nfunction App() {\n  return (\n    <SharePage />\n  );\n}\n\nReactDOM.render(<App />, document.getElementById(\"root\"));\n","import React, { useState, useMemo } from \"react\";\nimport SiteWrapper from \"../../SiteWrapper\";\nimport { Row, Col, Container } from \"react-bootstrap\";\nimport \"./SharePage.scss\";\nimport { Preview } from \"./preview\";\nimport { saveAs } from 'file-saver'\nimport ReactLoading from \"react-loading\";\n\ndeclare global {\n  interface window {\n    OpacityFile: {\n      shortlink: string,\n      url: string,\n      title: string,\n      description: string,\n      thumbnail: string,\n      mimeType: string,\n      fileExtension: string,\n      opacityUrl: string,\n    }\n  }\n}\n\nconst SharePage = ({ history }) => {\n  const file = useMemo(() => window.OpacityFile, [window.OpacityFile])\n  const [pageLoading, setPageLoading] = useState(false)\n\n  const downloadFile = async () => {\n    setPageLoading(true)\n    await fetch(`${file.url}`)\n      .then(res => res.blob())\n      .then(res => {\n        const blob = new Blob([res])\n        saveAs(blob, file.title)\n        setPageLoading(false)\n      })\n  }\n\n\n  return (\n    <>\n      <SiteWrapper history={history}>\n        <Container fluid='xl share'>\n          <Row>\n            <Col md={6} xs={12} className='center' >\n              <Row style={{ padding: '20px' }}>\n                <div className='preview-area center'>\n                  <Preview\n                    url={file.url}\n                    ext={file.fileExtension}\n                    type={file.mimeType}\n                    className='preview-content'\n                  />\n                </div>\n              </Row>\n            </Col>\n            <Col md={6} xs={12} className=\"control-area\">\n              <Row className='align-items-center'>\n                <Col className='text-center'>\n                  <div className='text-filename'>{file && file.title}</div>\n                  <div className=\"text-filesize\">\n                    {file && file.description}\n                  </div>\n                  <div className=\"row mb-3\" style={{ justifyContent: \"center\" }}>\n                    <div className=\"col-md-5\">\n                      <button\n                        className=\"btn btn-pill btn-download\"\n                        onClick={downloadFile}\n                      >\n                        <span></span>\n                      Download File\n                    </button>\n                    </div>\n                    {/* <div className=\"col-md-5\">\n                      <button\n                        className=\"btn btn-pill btn-preview\"\n                        onClick={() => setPreviewOpen(prev => !prev)}\n                      >\n                        <span></span>\n                        {previewOpen ? \"Hide\" : \"Show\"} Preview\n                    </button>\n                    </div> */}\n                  </div>\n\n                  <h2>Easily share your files with Opacity</h2>\n\n                  <div className=\"free-signup-text\">\n                    <a href={window.OpacityFile.opacityUrl + \"plans\"} target='_blank'>Get 10GB file storage and file sharing for free</a>\n                  </div>\n                  <div style={{ fontSize: \"1.1rem\" }}>\n                    Free to share ideas. Free to be protected. Free to be you.\n                </div>\n                </Col>\n              </Row>\n            </Col>\n          </Row>\n        </Container>\n        {\n          pageLoading && <div className='loading'>\n            <ReactLoading type=\"spinningBubbles\" color=\"#2e6dde\" />\n          </div>\n        }\n      </SiteWrapper >\n    </>\n  )\n}\n\nexport default SharePage;\n","// @flow\n\nimport * as React from \"react\";\nimport type { ReactElement, ReactNode } from \"react\";\nimport { Nav, Button } from \"tabler-react\";\nimport AOS from \"aos\";\nimport type { NotificationProps } from \"tabler-react\";\nimport Footer from \"opacity-web2.0/src/components/footer/footer\";\nimport \"aos/dist/aos.css\";\n\nAOS.init({\n  once: true,\n  anchorPlacement: \"center-bottom\",\n  offset: 200,\n  delay: 50,\n  duration: 700,\n});\nconst logo = require(\"./assets/logo.svg\");\ntype Props = {\n  children: ReactNode;\n  showSignUpModal?: boolean;\n  handleCloseSignUpModal?: Function;\n  showLoginModal?: boolean;\n  handleCloseLoginModal?: Function;\n  isHome?: boolean;\n  history: any;\n  recoveryHandle: string;\n};\n\ntype State = {\n  notificationsObjects?: Array<typeof NotificationProps>;\n  showMobileMenu: boolean;\n  showLoginModal: boolean;\n  showSignUpModal: boolean;\n};\n\nclass SiteWrapper extends React.Component<Props, State> {\n  constructor(props) {\n    super(props);\n    this.state = {\n      showMobileMenu: false,\n      showLoginModal: false,\n      showSignUpModal: false,\n    };\n  }\n  SetMobileMenu() {\n    this.setState({ showMobileMenu: !this.state.showMobileMenu });\n  }\n\n  render(): ReactElement {\n    const loggedIn = localStorage.getItem('key') ? true : false;\n    return (\n      <div className='page'>\n        <header\n          className={\n            this.props.isHome\n              ? \"navbar navbar-expand-md navbar-light d-print-none \"\n              : \"navbar navbar-expand-md navbar-light d-print-none border-bottom\"\n          }\n        >\n          <div className='container-xl'>\n            <h1 className='navbar-brand navbar-brand-autodark d-none-navbar-horizontal pe-0 pe-md-3 mb-0'>\n              <a href={window.OpacityFile.opacityUrl} className='logo-wrapper'>\n                <img src={logo} width='60' height='60' alt='Opacity' className='navbar-brand-image' />\n                <span className='ml-3'>OPACITY</span>\n              </a>\n            </h1>\n            <button\n              className='navbar-toggler'\n              type='button'\n              data-bs-toggle='collapse'\n              data-bs-target='#navbar-menu'\n              aria-expanded={this.state.showMobileMenu}\n              onClick={this.SetMobileMenu.bind(this)}\n            >\n              <span className='navbar-toggler-icon'></span>\n            </button>\n\n            <div className='collapse navbar-collapse' id='navbar-menu'>\n              <div className='d-flex flex-column flex-md-row flex-fill align-items-stretch align-items-md-center justify-content-end'>\n                <ul className='navbar-nav'>\n                  <li className='nav-item'>\n                    <a href={window.OpacityFile.opacityUrl + 'platform'} className='nav-link'>\n                      Why Opacity?\n                    </a>\n                  </li>\n                  <li className='nav-item'>\n                    <a href={window.OpacityFile.opacityUrl + 'community'} className='nav-link'>\n                      App Gallery\n                    </a>\n                  </li>\n                  <li className='nav-item'>\n                    <Nav.Link href={window.OpacityFile.opacityUrl + 'blog'}>Learn</Nav.Link>\n                  </li>\n                  <li className='nav-item'>\n                    {loggedIn ?\n                      (\n                        <div className='nav-link'>\n                          <Button\n                            className='btn btn-primary'\n                            onClick={() => {\n                              window.open(`${window.OpacityFile.opacityUrl}file-manager`, '_blank');\n                            }}\n                          >\n                            Dashboard\n                        </Button>\n                        </div>\n                      ) : (\n                        <div className='nav-link'>\n                          <Button\n                            className='btn btn-white btn-pill'\n                            onClick={() => {\n                              window.open(`${window.OpacityFile.opacityUrl}plans`, '_blank');\n                            }}\n                          >\n                            Explore Plans\n                      </Button>\n                        </div>\n                      )\n                    }\n\n                  </li>\n                  <li className='nav-item'>\n                    {loggedIn ? (\n                      <div className=''>\n                        <Button\n                          className='btn btn-primary'\n                          onClick={() => {\n                            window.open(`${window.OpacityFile.opacityUrl}`, '_blank');\n                          }}\n                        >\n                          Logout\n                        </Button>\n                      </div>\n                    ) : (\n                      <div className=''>\n                        <Button\n                          className='btn btn-primary btn-pill'\n                          onClick={() => {\n                            window.open(`${window.OpacityFile.opacityUrl}`, '_blank');\n                          }}\n                        >\n                          Log in\n                      </Button>\n                      </div>\n                    )}\n\n                  </li>\n                </ul>\n              </div>\n            </div>\n            {this.state.showMobileMenu && (\n              <div className='mobile-menu'>\n                <div className='d-flex flex-column flex-md-row flex-fill align-items-stretch align-items-md-center justify-content-center'>\n                  <ul className='navbar-nav'>\n                    <li className='nav-item'>\n                      <a href={window.OpacityFile.opacityUrl + 'platform'} className='nav-link'>\n                        Why Opacity?\n                    </a>\n                    </li>\n                    <li className='nav-item'>\n                      <a href={window.OpacityFile.opacityUrl + 'community'} className='nav-link'>\n                        App Gallery\n                    </a>\n                    </li>\n                    <li className='nav-item'>\n                      <Nav.Link href='/blog'>Learn</Nav.Link>\n                    </li>\n\n                    {\n                      loggedIn ? (\n                        <>\n                          <li className='nav-item'>\n                            <a href={window.OpacityFile.opacityUrl + 'file-manager'} className='nav-link' >\n                              Dashboard\n                            </a>\n                          </li>\n                          <li\n                            className='nav-item'\n                            onClick={() => {\n                              window.open(`${window.OpacityFile.opacityUrl}`, ' _blank');\n                            }}\n                          >\n                            <Nav.Link>Logout</Nav.Link>\n                          </li>\n                        </>\n                      ) : (\n                        <>\n                          <li className='nav-item'>\n                            <Nav.Link href='/plans'>Explore Plans</Nav.Link>\n                          </li>\n                          <li\n                            className='nav-item'\n                            onClick={() => {\n                              this.setState({ showLoginModal: true });\n                            }}\n                          >\n                            <Nav.Link>Log in</Nav.Link>\n                          </li>\n                        </>\n                      )\n                    }\n\n                  </ul>\n                </div>\n              </div>\n            )}\n          </div>\n        </header>\n        {this.props.children}\n        <Footer />\n      </div>\n    );\n  }\n}\n\nexport default SiteWrapper;\n","import React, { useEffect } from \"react\";\nimport { PreviewRenderer } from \"./preview-renderer\";\nimport ReactMarkdown from \"react-markdown\";\n\nconst getTypeFromExt = (ext?: string) => {\n  ext = (\"\" + ext).replace(/^\\./, \"\");\n\n  if ([\n    \"png\",\n    \"apng\",\n    \"svg\",\n    \"gif\",\n    \"bmp\",\n    \"ico\",\n    \"cur\",\n    \"jpg\",\n    \"jpeg\",\n    \"jfif\",\n    \"pjpeg\",\n    \"pjp\",\n    \"webp\"\n  ].includes(ext)) {\n    return \"image\";\n  }\n\n  if ([\n    \"mp4\",\n    \"ogg\",\n    \"webm\"\n  ].includes(ext)) {\n    return \"video\";\n  }\n\n  if ([\n    \"mp3\",\n    \"flac\"\n  ].includes(ext)) {\n    return \"audio\";\n  }\n\n  if ([\n    \"txt\",\n    \"md\",\n  ].includes(ext)) {\n    return \"text\";\n  }\n\n  return undefined;\n};\n\ntype PreviewProps = {\n  ext: string\n  type?: string\n  url: string\n  className?: string\n  onLoad?: () => void\n  onUnload?: () => void\n};\n\nconst Preview = ({\n  ext,\n  type,\n  url,\n  className,\n  onLoad,\n  onUnload\n}: PreviewProps) => {\n  useEffect(() => {\n    onLoad && onLoad();\n\n    return () => {\n      onUnload && onUnload();\n    };\n  });\n\n  const newType = \"\" + (type || getTypeFromExt(ext));\n\n  switch (newType.split(\"/\")[0]) {\n    case \"image\":\n      return <img className={className} src={url} />;\n    case \"video\":\n      return (\n        <video\n          className={className}\n          controls={true}\n        >\n          <source src={url} type={type} />\n          Your browser doesn't support this video type.\n        </video>\n      );\n    case \"audio\":\n      return (\n        <audio\n          className={className}\n          controls={true}\n        >\n          <source src={url} type={type} />\n          Your browser doesn't support this audio type.\n        </audio>\n      );\n    case \"text\":\n      switch (newType.split(\"/\")[1]) {\n        case \"markdown\":\n          return (\n            <div className={className}>\n              <PreviewRenderer\n                url={url}\n                render={text => <ReactMarkdown source={text} />}\n              />\n            </div>\n          );\n        default:\n          return (\n            <div className={className}>\n              <PreviewRenderer url={url} />\n            </div>\n          );\n      }\n    default:\n      return <img className={className} src={url} />;\n  }\n};\n\nexport { getTypeFromExt, Preview, PreviewProps };\n","import React, { useEffect, useState } from \"react\";\n// import Spinner from \"../../components/shared/spinner\";\n\ntype PreviewRendererProps = {\n  url: string,\n  render?: (text: string) => JSX.Element | JSX.Element[]\n};\n\nconst PreviewRenderer = ({\n  url,\n  render = text => (\n    <div\n      onClick={e => {\n        const selection = getSelection();\n\n        if (selection && selection.isCollapsed) {\n          const range = document.createRange();\n          range.selectNode(e.currentTarget);\n\n          selection.removeAllRanges();\n          selection.addRange(range);\n        }\n      }}\n      style={{\n        textAlign: 'left',\n      }}\n    >\n      {text.split(/\\n+/).map((paragraph, i) => <p key={i}>{paragraph}</p>)}\n    </div>\n  )\n}: PreviewRendererProps) => {\n  const [text, setText] = useState<string>();\n\n  useEffect(() => {\n    fetch(url)\n      .then(res => res.text())\n      .then(text => setText(text))\n      .catch(err => console.warn(err));\n  }, [url]);\n\n  return (\n    <>\n      {/* <Spinner isActive={!text} /> */}\n      {text && render(text)}\n    </>\n  );\n};\n\nexport { PreviewRenderer, PreviewRendererProps };\n"]}